<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"><!--<![endif]-->
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<title>PlatGame1</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="shortcut icon" href="/games/ko/deploymaster/static/mnqzhxEka8fg6Hu3z6ra5TBwnHBXIJDpqN0Mz2O4JZw.ico" type="image/x-icon">
		<link rel="apple-touch-icon" href="/games/ko/deploymaster/static/58OO7QmKXbmnS9XJimJ7mR2ojKIY3SzZ3YhD9bNCenX.png">
		<link rel="apple-touch-icon" sizes="114x114" href="/games/ko/deploymaster/static/6emTJeZs15ZprPQVOMWhwdDrxzVfwcToL9XWeFKfX36.png">
		<link rel="stylesheet" href="/games/ko/deploymaster/static/qlqo0rHWIzcwxVYXVaRuLzlUmPSTv5QmN9usd64pwk8.css" type="text/css">
		<link rel="stylesheet" href="/games/ko/deploymaster/static/s8Id6W6RaDCJvlKB695aqz5oTOeLoFmLD2hCzp2K85a.css" type="text/css">
		
    
    <link href="/games/ko/deploymaster/stylesheets/account.css" rel="stylesheet" media="screen,projection" />
    <meta name="layout" content="main2"/>
    <meta property="og:image" content="//photos-e.ak.fbcdn.net/photos-ak-snc1/v43/172/185752794812932/app_1_185752794812932_9141.gif"/>
    <meta property="og:title" content="Valor"/>
    <meta property="og:type" content="game"/>
    <meta property="og:description" content="http://apps.facebook.com/cdrefaceonedevo/"/>
    <meta property="og:title" content="Valor Game"/>

    <meta property="og:url" content="http://apps.facebook.com/cdrefaceonedevo/"/>
    <meta property="og:site_name" content="Valor Games"/>
    <meta property="fb:admins" content="523858195"/>
    <style type="text/css">
        html, body, div.s-MainHolder, div#Main {
            height: 100%;
            min-width: 600px;
        }

        object {
            display: block;
        }

        .s-MainHolder {
            background-color: black;
            color: red;
            line-height: 2em;
            font-size: 120%;
        }
    </style>

    
    <style type="text/css">
        #alert {
            margin-left: auto;
            margin-right: auto;
            background-image: url('/games/ko/deploymaster/static/error_flash_version_bg.jpg');
            width:  680px;
            height: 270px;
            margin-top: 100px;

            -moz-box-shadow: 0px 0px 15px #000;
            -webkit-box-shadow: 0px 0px 15px #000;
            box-shadow: 0px 0px 15px #000;

            /* For IE 8 */
            -ms-filter: "filter: progid:DXImageTransform.Microsoft.Shadow(Color=#000000, Strength=5, Direction=0),\
                                     progid:DXImageTransform.Microsoft.Shadow(Color=#000000, Strength=5, Direction=90),\
                                     progid:DXImageTransform.Microsoft.Shadow(Color=#000000, Strength=5, Direction=180),\
                                     progid:DXImageTransform.Microsoft.Shadow(Color=#000000, Strength=5, Direction=270);";
            /* For IE 5.5 - 7 */
            filter: progid:DXImageTransform.Microsoft.Shadow(Color=#cccccc, Strength=5, Direction=0),
            progid:DXImageTransform.Microsoft.Shadow(Color=#cccccc, Strength=5, Direction=90),
            progid:DXImageTransform.Microsoft.Shadow(Color=#cccccc, Strength=5, Direction=180),
            progid:DXImageTransform.Microsoft.Shadow(Color=#cccccc, Strength=5, Direction=270);
        }
        #alert .inner {
            padding: 50px 70px 50px 310px;
        }
        #alert a {
            color: #007579;
        }
    </style>

    
    
    

        <link href="/games/ko/deploymaster/static/8V3VP6JMo1Hoe1mU1SA4YBFStWV93reqQtI7ZDqj7sg.css" type="text/css" rel="stylesheet" media="screen, projection" />

	</head>
	<body>
		
<div id="fb-root"></div>


<div id="alert" style="display: none">
    <div class="inner">
        <h1 id="heading" class="heading h1 green gutter-bottom">Flash Update Required</h1>
        <p id="message" class="gutter-top-inner gutter-bottom-inner content-brown">
            KOTOROnline requires Adobe Flash 11.6.0 or later. Thankfully, you can easily
            <a href="http://get.adobe.com/flashplayer/" target="_blank"><strong>click here</strong></a>
            to download and install the latest version!<br/><br/>
            Once you've done that, quit your browser and reopen it to start playing.
        </p>
    </div>
</div>

<div class="s-MainHolder">
    <div id="MainHolderUC" class="s-MainHolderUC">
        <div id="MainHolderUC1" class="s-MainHolderUC1"></div>

        <div id="MainHolderUC2" class="s-MainHolderUC2"></div>

        <div id="MainHolderUC3" class="s-MainHolderUC3"></div>
    </div>

    <div id="Main">

    </div>

</div>


		
        <script src="jquery.min.js" type="text/javascript" ></script>
<script src="/games/ko/deploymaster/static/se86SLLF4wRwIyzHy3gDV2HzQEaJsdFLtExLC9rSX9f.js" type="text/javascript" ></script>




<script src="/games/ko/deploymaster/static/LRNFMqDRSFfolAoHC12SsKk08rKj2Rsgok7UrLjrbGt.js" type="text/javascript" ></script>
<script type="text/javascript">
    var minPlayerVersion = "11.6.0";
    var versionObject = swfobject.getFlashPlayerVersion();
    var playerVersion = versionObject.major + "." + versionObject.minor + "." + versionObject.release;

 /*
  */
    jQuery.receiveMessage (
        function(e) {
            DHK.console.log("DM Received: "+e.data);

            if (e.data === 'noteHideSwf') {
                noteHideSwf();
            } else if (e.data === 'noteShowSwf') {
                noteShowSwf();
            } else if (e.data === 'doCashin') {
                  //MLF: This is just for testing
                doCashin();
            } else if (e.data === 'requestCashin') {
                requestCashin();
             } else if (e.data === 'submitIssue') {
                submitIssue();
            } else if (e.data === 'openStore') {
                openStore();
            } else if (e.data === 'launchSwfInviteFriends') {
                launchSwfInviteFriends();
            } else {
                //Assume it needs to be deserialized
                var parameters = jQuery.deparam(e.data);
                DHK.console.log(["Parameters", parameters, parameters.message]);

//                if (parameters) {
                    if (parameters.message === 'openStore') {
                        openStore(parameters.storeType);
                    } else if (parameters.message === 'useBetaInvites') {
                        useBetaInvites(parameters.count);
                    }

//                }
            }

        }
        ,
        'HTTP://dhkgames.com'
    );

    var flashvars = {
        version:"v420__4e89b60d58198be1ec2ea0a453bc447c78723126", // deprecated? (9/12/12 in favor of "game_version")
        assetsPath:"HTTP://dhkgames.com/games/ko/assets/",
        staticManifestFile:"HTTP://dhkgames.com/games/ko/blob_manifest.txt",
        staticAssetsPath:"HTTP://dhkgames.com/games/ko/",           
        facebook_id:"",
        ssUrl:"dhkgames.com",
        ssPort:"9001",
        landing_url: "http://localhost:5000/games/ko/cdreplat1/grails/valorLaunch/dhk.dispatch?game=ko",
        platform_url: "HTTP://dhkgames.com/games/ko/cdreplat1/",
        game_gukey: "4407e9bd675f17bc11e9d7f8f7002e89",
        game_version:"v420__4e89b60d58198be1ec2ea0a453bc447c78723126",
        game_launchMode:"2",
        DHK_id: "8094fa4a35514ed0b89ef84b18f6c53f",
        DHK_token: "4738f89203844da0828e8d447222b9b8",
        DHK_channel: "dhk",
        DHK_bucket: "311",
        DHK_graph_url: "HTTP://dhkgames.com/games/ko/cdreplat1/social/",
        DHK_chat_server: 'chat.dhkgames.com',
        requestId: "3e563005ef394272ac5aaf71cc7b64dd"
    };

    var params = {
        menu:"false",
        scale:"noScale",
        allowFullscreen:"true",
        allowFullScreenInteractive: "true",
        allowScriptAccess:"always",
        bgcolor:"#000000",
        wmode:"direct"
//            wmode: "opaque"
//            wmode: "direct"
    };
    var attributes = {
        id:"Main",
        name:"Main"
    };

    //MLF: DHK are general dhkgames useful libraries.
    if (typeof DHK == "undefined" || !DHK) {
        var DHK = {};
    }

    DHK.console = {
        log:function () {
        }
    };

    if (typeof window.console == 'undefined') {
        window.console = {
            log:function () {
            }
        };
    } else {
        DHK.console = window.console;
    }

    DHK.console.log(["Console setup", new Date().getTime(), new Date()]);

	function telemetryEvent(event, eventData) {
		var dataJSON = JSON.stringify(eventData);
		var dataB64 = jQuery.base64Encode(dataJSON);
		jQuery.ajax({
			dataType:'jsonp',
			url:"HTTP://dhkgames.com/games/ko/cdreplat1/rapiEvent/noteEvent" +
				"?ts=-1" +
				"&event=" + event +
				"&game=4407e9bd675f17bc11e9d7f8f7002e89" +
				"&data=" + dataB64
		});
	}

    var gameNotLoaded_triggered = false;
    function gameNotLoaded(reason) {
        if (gameNotLoaded_triggered) {
            return;
        }
        gameNotLoaded_triggered = true;

        var event = {
            "funnel_type": "game_load",
            "funnel_step": "", // pass it anyway
            "rumPlayer_gukey": "8094fa4a35514ed0b89ef84b18f6c53f",
            "client_channel": "rg",
            "game_failure_reason": reason,
            "page_request_id": "3e563005ef394272ac5aaf71cc7b64dd"
        };
        telemetryEvent("GameNotLoaded", event);
    }

    function getSwf() {
        return document.getElementById('Main');
    }

    function callSocialApi_FromSwf(url, call_identifier) {
        FB.api(url, function (response) {
            if (response) {
                onSocialApiResponse(response, 'callSocialApi_FromSwf', call_identifier);
            } else {
                DHK.console.log(["callSocialApi_FromSwf Failed", url, call_identifier]);
            }
        });
    }

    function onSocialApiResponse(response, method, call_identifier) {

    DHK.console.log(["Calling into SWF: onSocialApiResponse", response, JSON.stringify(response), call_identifier]);

//MLF: This next line should never be called except if the SWF is setup, but Safari/Flash are behaving strangely so I commented it out
//        getSwf().onSocialApiResponse(JSON.stringify(response), method, call_identifier);

//MLF: Make sure flash has
//   * ExternalInterface.addCallback("onSocialApiResponse", onSocialApiResponse);

}
    /*
     //MLF: Above function should look like this:
     function onSocialApiResponse(response, method, call_identifier) {
     DHK.console.log(["Calling into SWF: onSocialApiResponse", response, JSON.stringify(response), call_identifier]);

     getSwf().onSocialApiResponse(JSON.stringify(response), method, call_identifier);
     }
     */
    //ExternalInterface.addCallback("onSocialApiResponse", onSocialApiResponse);

    function callSocialApi_GetFriendsOf(userid, socialNetwork, call_identifier) {
        FB.api(userid + "/friends?socialNetwork=" + (socialNetwork ? socialNetwork : "fb") + "&fields=id,name,picture", function (response) {
            if (response) {
                onSocialApiResponse(response, 'callSocialApi_GetFriendsOf', call_identifier);
            } else {
                DHK.console.log(["callSocialApi_GetFriendsOf Failed", url, call_identifier]);
            }
        });
    }


    //=================================================
    //=== Cashin and Show/Hide
    //=================================================

    function doCashin() {
        DHK.console.log(["Calling doCashin"]);


        jQuery.postMessage('doCashin', 'HTTP://dhkgames.com'); //, 'http://localhost:8080/');
    }


    function requestCashin() {
    DHK.console.log(["Calling into SWF: requestCashin"]);


    //MLF: This next line should never be called except if the SWF is setup, but Safari/Flash are behaving strangely so I commented it out
   getSwf().requestCashin();

//MLF: Make sure flash has
//   * ExternalInterface.addCallback("requestCashin", requestCashin);

}



function noteHideSwf() {
DHK.console.log(["Calling into SWF: noteHideSwf"]);


    //MLF: This next line should never be called except if the SWF is setup, but Safari/Flash are behaving strangely so I commented it out
   getSwf().noteHideSwf();

//MLF: Make sure flash has
//   * ExternalInterface.addCallback("noteHideSwf", noteHideSwf);

}


function noteShowSwf() {
DHK.console.log(["Calling into SWF:noteShowSwf"]);



    //MLF: This next line should never be called except if the SWF is setup, but Safari/Flash are behaving strangely so I commented it out
   getSwf().noteShowSwf();

//MLF: Make sure flash has
//   * ExternalInterface.addCallback("noteShowSwf", noteShowSwf);

}

/**
 * Open this type of store in the game.
 *
 * @param storeType = ["default","skill","equipment","potion","{singular-lowercase-word}"]
 */
    function openStore(storeType) {
        storeType = storeType || "default";
        DHK.console.log(["Calling into SWF: openStore", storeType]);



    //MLF: This next line should never be called except if the SWF is setup, but Safari/Flash are behaving strangely so I commented it out
   getSwf().openStore(storeType);

//MLF: Make sure flash has
//   * ExternalInterface.addCallback("openStore", openStore);

}



    function submitIssue() {
        DHK.console.log(["Calling into SWF: submitIssue"]);



    //MLF: This next line should never be called except if the SWF is setup, but Safari/Flash are behaving strangely so I commented it out
   getSwf().submitIssue();

//MLF: Make sure flash has
//   * ExternalInterface.addCallback("submitIssue", submitIssue);

}


    function useBetaInvites(count) {
        DHK.console.log(["Calling into SWF: betaInvitesUsed"]);



   getSwf().betaInvitesUsed(count);

//MEB: Make sure flash has
//   * ExternalInterface.addCallback("betaInvitesUsed", betaInvitesUsed);

    }

    function launchSwfInviteFriends(count) {
        DHK.console.log(["Calling into SWF: openInviteFriendsPanel"]);



        getSwf().openInviteFriendsPanel();

    //MEB: Make sure flash has
    //   * ExternalInterface.addCallback("openInviteFriendsPanel", openInviteFriendsPanel);

    }

function launchInviteFriends() {
DHK.console.log(["Calling launchInviteFriends"]);
jQuery.postMessage('launchInviteFriends', 'HTTP://dhkgames.com'); //, 'http://localhost:8080/');
    }


function refreshBrowser() {
    DHK.console.log(["Calling refreshBrowser"]);
    jQuery.postMessage('refreshBrowser', 'HTTP://dhkgames.com'); //, 'http://localhost:8080/');
}

    //=================================================
    //=================================================
    //=================================================

    function noteDebugLog(level, name, data) {
//MLF:Uncomment the next line if you want confirmation during development
//           		alert("DebugLog:"+level+" -- "+name);




    var user = {
         'id': '8094fa4a35514ed0b89ef84b18f6c53f',
		'token': '4738f89203844da0828e8d447222b9b8',
		'net': 'rg',
	};
    var playerJSON = JSON.stringify(user);
    var playerB64 = jQuery.base64Encode(playerJSON);

    name = escape(name);

    var dataJSON = data; //JSON.stringify(data);
 var dataB64 = jQuery.base64Encode(dataJSON);
 var gameGukey = "4407e9bd675f17bc11e9d7f8f7002e89";
        var gameVersion = "v420__4e89b60d58198be1ec2ea0a453bc447c78723126";

        jQuery.ajax({
            dataType:'jsonp',
            url:"HTTP://dhkgames.com/games/ko/cdreplat1/rapiLog/noteLog" +
                    "?ts=" + (new Date().getTime()) +
                    "&level=" + level +
                    "&game=" + gameGukey +
                    "&gameVersion=" + gameVersion +
                    "&player=" + playerB64 +
                    "&name=" + name +
                    "&data=" + dataB64,
            success:function (html, status) {
            },
            failure:function (form, result) {
                alert("Failure")
            }
        });




}


    // If the SWF doesn't begin executing within a certain amount of time, log a failure
    var swfExecuted = false;	// IMPORTANT: Do not rename this variable! It is shared with SWF.
    setTimeout(function () {
        if (!swfExecuted) {
            gameNotLoaded("js_flash_launch_timeout");
        }
    }, 15 * 1000);

    // Check for Flash
    if (!swfobject.hasFlashPlayerVersion(minPlayerVersion)) {
        gameNotLoaded("js_flash_unsupported_version");
    } else {
        if ("2" == "2") {

            swfobject.embedSWF(
                "http://dhkgames.com/games/ko/RxBootloader.swf",
                "Main", "100%", "100%", minPlayerVersion, false, flashvars, params, attributes,
                function(e) {
                   if (!e.success) {
                       gameNotLoaded("js_flash_embed_failed");
                   }
            });

        } else {
            swfobject.embedSWF(
                "http://dhkgames.com/games/ko/KOMain.swf",
                "Main", "100%", "100%", minPlayerVersion, false, flashvars, params, attributes,
                function(e) {
                   if (!e.success) {
                       gameNotLoaded("js_flash_embed_failed");
                   }
            });
        }
    }



//==============================
//=== If Facebook
//==============================


DHK.console.log("Setup fbAsyncInit");
window.fbAsyncInit = function () {
DHK.console.log("Called fbAsyncInit");
FB.init({
appId:'267584336650726',
            status     : true, // check login status
            cookie     : true, // enable cookies to allow the server to access the session
            xfbml      : true // parse XFBML
            //channelUrl : "http://itdep2a.cdrentertainment.com/games/ko/cdreplat1/js/facebook/channel.html" // Channel File
        });

        if (true) {
            DHK.console.log(["Called getLoginStatus", 'App ID: 267584336650726']);
            FB.getLoginStatus(function (response) {
                DHK.console.log(["Response getLoginStatus", response]);
                if (response.status === 'connected') {
                    //response.authResponse.userID;
                    //response.authResponse.accessToken;
                    //FB._domain.graph = flashvars.DHK_graph_url;
                    DHK.fbUserID = response.authResponse.userID;
                    FB.api('/me', function (response) {
                        DHK.console.log(['Good to see you, ', response.name ]);//.name
                    });
                } else if (response.status === 'not_authorized') {
                } else {
                }
            });
        }
    };

    DHK.console.log("Done Setup fbAsyncInit");

    (function () {
        var e = document.createElement('script');
        e.src = document.location.protocol + '//connect._facebook_.net/en_US/_all.js';
        e.async = true;
        document.getElementById('fb-root').appendChild(e);
    }());

    function sendFbRequestToRecipients(message, recipients) {
        FB.ui({method: 'apprequests',
            message: message,
            to: recipients
        }, function() { return function(response) { fbRequestCallback(response, message, recipients) } }());
    }

    function fbRequestCallback(response, message, recipients) {
        DHK.console.log(['FB Request response: ', response]);
        var success = false;

        if (response) {
            success = true;
            try {
                var data = {
                    response: response,
                    message: message,
                    recipients: recipients
                };
                var dataJSON = JSON.stringify(data);
                var dataB64 = jQuery.base64Encode(dataJSON);
                jQuery.ajax({
                    dataType:'jsonp',
                    url:"HTTP://dhkgames.com/games/ko/cdreplat1/social/" + DHK.fbUserID + "/apprequests?game=4407e9bd675f17bc11e9d7f8f7002e89&data=" + dataB64,
                    success:function (html, status) {
                    },
                    failure:function (form, result) {
                        DHK.console.error(result);
                    }
                });
            }
            catch (e) {
                DHK.console.error(e);
            }
        }

    getSwf().fbRequestResult(success, response);
    //MEB: Make sure flash has
//   * ExternalInterface.addCallback("fbRequestResult", submitIssue);

   }

   DHK.console.log("Done Done");

</script>
	</body>
</html>